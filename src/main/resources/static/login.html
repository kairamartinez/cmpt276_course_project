<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA_Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width" , initial-scale="1.0">
  <title>SoSy Course Planner</title>
  <link rel="stylesheet" href="stylesheets/login.css">
  <link rel="stylesheet" href="stylesheets/navbar.css">
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
</head>

<body>
  <header class="header">
    <a href="https://sfussss.org/" class="logo" target="_blank" onclick="confirmRedirect()"></a>

    <nav class="navbar">
      <a href="/">Home</a>
      <a href="https://sfussss.org/events" target="_blank" onclick="confirmRedirect()">Events</a>
      <a href="https://sfussss.org/get-involved" target="_blank" onclick="confirmRedirect()">Get Involved</a>
      <a href="https://sfussss.org/resources" target="_blank" onclick="confirmRedirect()">Resources</a>
      <a href="https://sfussss.org/blog" target="_blank" onclick="confirmRedirect()">Blog</a>

      <a href="https://sfussss.org/courses" target="_blank" onclick="confirmRedirect()">Courses</a>
      <a href="mailto:ssss-exec@sfu.ca" rel="noreferrer">Contact Us</a>
      <script>
        function confirmRedirect() {
          alert("You will be redirected to an external website.")
        }
      </script>
    </nav>
  </header>
  <div class="wrapper">

    <form action="/users/login" method="post">


      <script>
        document.addEventListener('DOMContentLoaded', function () {
          const urlParams = new URLSearchParams(window.location.search);
          const loginError = urlParams.get('error');

          if (loginError) {
            alert("Invalid username or password. Please try again!");
          }
        });
      </script>

      <script>
        document.addEventListener('DOMContentLoaded', function () {
          const urlParams = new URLSearchParams(window.location.search);
          const successMessage = urlParams.get('success');
          const errorMessage = urlParams.get('error');

          if (successMessage) {
            alert(decodeURIComponent(successMessage.replace(/\+/g, ' ')));
          }

          if (errorMessage) {
            alert(decodeURIComponent(errorMessage.replace(/\+/g, ' ')));
          }
        });
      </script>

      <h1>Login</h1>

      <div class="input-box">
        <input type="text" id="username" name="name" placeholder="Username@sfu.ca" pattern="^.+@sfu\.ca$"
          title="Username must end with @sfu.ca" required>
        <i class='bx bxs-user'></i>
      </div>

      <script>
        document.getElementById('username').addEventListener('input', function (e) {
          var username = e.target.value;
          var pattern = new RegExp(e.target.pattern);
          if (pattern.test(username)) {
            // The username ends with @sfu.ca
            e.target.setCustomValidity('');
          } else {
            // The username does not end with @sfu.ca
            e.target.setCustomValidity('Username must end with @sfu.ca');
          }
        });
      </script>

      <div class="input-box">
        <input type="password" id="password" name="password" placeholder="Password" required>

        <i class='bx bxs-show' onclick="togglePasswordVisibility('password',this)"></i>
      </div>


      <script>
        function togglePasswordVisibility(inputId, icon) {
          var input = document.getElementById(inputId);

          if (input.type === "password") {
            input.type = "text";
            icon.className = 'bx bxs-hide'; // Change to eye closed icon when password is visible
          } else {
            input.type = "password";
            icon.className = 'bx bxs-show'; // Change to eye open icon when password is hidden
          }
        }
      </script>
      <button type="submit" class="btn">Login</button>
      <div class="register-link">
        <p>Don't have an account?
          <a href="register.html">Register</a>
          <a href="https://my.sfu.ca/account/PasswordReset" target="_blank" onclick="confirmRedirect()"
            style="display: block; margin-top: 1em;">Forgot Password?</a>
        </p>

      </div>
      <script>
        function confirmRedirect() {
          alert("You will be redirected to an external website.")
        }
      </script>


</body>

</html>